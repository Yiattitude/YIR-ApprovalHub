# å®¡æ‰¹ç³»ç»Ÿ - API æ¥å£æ–‡æ¡£

æœ¬æ–‡ä»¶èšç„¦â€œæ¥å£åšä»€ä¹ˆâ€å’Œâ€œä»€ä¹ˆæ—¶å€™ç”¨â€ï¼Œå¼±åŒ–ç¤ºä¾‹ä»£ç ï¼Œæ–¹ä¾¿äº§å“ã€åç«¯ã€å‰ç«¯ã€æµ‹è¯•åŠå®æ–½åŒäº‹å¿«é€Ÿå¯¹é½æ¥å£èƒ½åŠ›ã€‚è‹¥éœ€è°ƒè¯•æ ·ä¾‹ï¼Œå¯ä½¿ç”¨ Postman Collectionï¼ˆé™„å½•ï¼‰æˆ– Swagger/Knife4j åœ¨çº¿æ–‡æ¡£ã€‚

## 1. æ¥å£è§„èŒƒ

- **ä¼ è¾“æ–¹å¼**ï¼šHTTPS/HTTPï¼Œæ¨è HTTPSï¼›å­—ç¬¦é›†ç»Ÿä¸€ UTF-8ã€‚
- **è¯·æ±‚ä¸å“åº”æ ¼å¼**ï¼šRESTful + JSONï¼›æ‰€æœ‰ç»“æœå‡å°è£…åœ¨ `code / message / data` ç»“æ„ä¸­ï¼Œ`code=200` è¡¨ç¤ºæˆåŠŸã€‚
- **Base URL**ï¼šå¼€å‘ `http://localhost:8080/api`ï¼›ç”Ÿäº§ `https://api.yourcompany.com`ã€‚
- **è®¤è¯æœºåˆ¶**ï¼šç™»å½•åè¿”å› JWTï¼Œåç»­è¯·æ±‚åœ¨ Header ä¸­æºå¸¦ `Authorization: Bearer <token>`ã€‚
- **å¸¸è§çŠ¶æ€ç **ï¼š400 å‚æ•°ä¸åˆæ³•ã€401 æœªç™»å½•ã€403 æƒé™ä¸è¶³ã€404 èµ„æºä¸å­˜åœ¨ã€500 æœåŠ¡ç«¯å¼‚å¸¸ï¼›ä¸šåŠ¡é”™è¯¯ç åœ¨é™„å½•åˆ—å‡ºã€‚
- **å¹‚ç­‰ä¸å®‰å…¨**ï¼šé™¤ `GET` è¯·æ±‚å¤–å‡éœ€æ ¡éªŒ CSRF/æƒé™ï¼›ä¸Šä¼ é™„ä»¶éœ€å¸¦ tokenï¼Œä¸‹è½½æ¥å£ä¼šæ ¡éªŒå¯è®¿é—®æ€§å¹¶è®°å½•å®¡è®¡æ—¥å¿—ã€‚

## 2. æ¥å£ç›®å½•

| æ¨¡å— | æ–¹æ³• | è·¯å¾„ | ç®€è¿° |
| --- | --- | --- | --- |
| è®¤è¯ | POST | /auth/register | å‘˜å·¥è‡ªåŠ©æ³¨å†Œå¹¶åˆå§‹åŒ–æ™®é€šå‘˜å·¥èº«ä»½ |
| è®¤è¯ | POST | /auth/login | è´¦å·å¯†ç ç™»å½•ï¼Œè¿”å› JWT ä¸ç”¨æˆ·æ¦‚è¦ |
| è®¤è¯ | GET | /auth/userinfo | æ ¹æ® token è·å–ä¸ªäººæ¡£æ¡ˆä¸å²—ä½æƒé™ |
| è®¤è¯ | POST | /auth/logout | ä¸»åŠ¨æ³¨é”€ã€ä½œåºŸ token |
| ç”³è¯· | POST | /application/leave | åˆ›å»ºè¯·å‡ç”³è¯·å• |
| ç”³è¯· | POST | /application/reimburse | åˆ›å»ºæŠ¥é”€ç”³è¯·å• |
| ç”³è¯· | GET | /application/my | æŸ¥è¯¢æœ¬äººå‘èµ·çš„æ‰€æœ‰ç”³è¯· |
| ç”³è¯· | GET | /application/{appId} | æŸ¥çœ‹æŒ‡å®šç”³è¯·çš„å®Œæ•´è¯¦æƒ… |
| ç”³è¯· | PUT | /application/withdraw/{appId} | æ’¤å›å°šæœªæµè½¬çš„ç”³è¯· |
| ä»»åŠ¡ | GET | /task/todo | å½“å‰å®¡æ‰¹äººå¾…åŠä»»åŠ¡åˆ—è¡¨ |
| ä»»åŠ¡ | POST | /task/approve | å¯¹å¾…åŠæ‰§è¡ŒåŒæ„/æ‹’ç»/è½¬äº¤ç­‰åŠ¨ä½œ |
| ä»»åŠ¡ | GET | /task/done | æŸ¥çœ‹ä¸ªäººå·²åŠè®°å½• |
| å†å² | GET | /history/{appId} | æŸ¥è¯¢å•æ®çš„æµè½¬è½¨è¿¹ä¸å®¡æ‰¹æ„è§ |
| æ–‡ä»¶ | POST | /file/upload | ä¸Šä¼ é™„ä»¶å¹¶è·å–å—æ§ä¸‹è½½åœ°å€ |
| æ–‡ä»¶ | GET | /file/download/{fileId} | å—æƒé™æ§åˆ¶çš„é™„ä»¶ä¸‹è½½ |
| æ–‡ä»¶ | DELETE | /file/{fileId} | åˆ é™¤æ— æ•ˆé™„ä»¶å¹¶å†™å…¥å®¡è®¡æ—¥å¿— |
| ç³»ç»Ÿç®¡ç† | GET | /system/user/list | ç®¡ç†å‘˜åˆ†é¡µæ£€ç´¢ç”¨æˆ· |
| ç³»ç»Ÿç®¡ç† | POST | /system/user | ç®¡ç†å‘˜åˆ›å»ºç”¨æˆ·å¹¶åˆ†é…è§’è‰² |
| ç³»ç»Ÿç®¡ç† | GET | /system/dept/tree | æŸ¥è¯¢éƒ¨é—¨æ ‘ç»“æ„ï¼Œä¾›é€‰æ‹©å™¨/æŒ‡æ´¾ä½¿ç”¨ |
| ç³»ç»Ÿç®¡ç† | POST | /system/dept | æ–°å¢æˆ–æ‰©å±•éƒ¨é—¨èŠ‚ç‚¹ |
| ç»Ÿè®¡ | GET | /statistics/personal | ä¸ªäººä»ªè¡¨ç›˜åŸºç¡€æ•°æ® |
| ç»Ÿè®¡ | GET | /statistics/dept | ç®¡ç†å‘˜æŸ¥çœ‹éƒ¨é—¨çº§ KPI |

## 3. æ¨¡å—è¯¦è§£

### 3.1 è®¤è¯æ¨¡å—

#### POST /auth/register
- **ä½œç”¨**ï¼šå…è®¸æ–°å‘˜å·¥è‡ªåŠ©åˆ›å»ºè´¦å·ï¼Œæäº¤åŸºç¡€ä¿¡æ¯åè‡ªåŠ¨è½åº“ä¸ºâ€œæ™®é€šå‘˜å·¥â€å¹¶ç­‰å¾…ç®¡ç†å‘˜åˆ†é…å²—ä½ã€‚
- **ä¸»è¦å­—æ®µ**ï¼šç”¨æˆ·åï¼ˆå”¯ä¸€ï¼‰ã€å¯†ç ä¸ç¡®è®¤å¯†ç ã€çœŸå®å§“åã€æ‰‹æœºå·ã€é‚®ç®±ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šæ³¨å†ŒæˆåŠŸå³è¿”å›ç”¨æˆ· IDï¼›æ•æ„Ÿå­—æ®µéœ€æœåŠ¡å™¨ç«¯æ ¡éªŒä¸åŠ å¯†ï¼›å¯æ‰©å±•å›¾å½¢éªŒè¯ç ä»¥é˜²æœºå™¨äººã€‚

#### POST /auth/login
- **ä½œç”¨**ï¼šè´¦å·å¯†ç ç™»å½•ï¼Œé¢å‘ JWT ä¸è§’è‰²/å²—ä½åˆ—è¡¨ï¼Œä¾›å‰ç«¯æ¸²æŸ“èœå•ä¸å†³å®šè·³è½¬é¡µã€‚
- **ä¸»è¦å­—æ®µ**ï¼šç”¨æˆ·åã€å¯†ç ï¼›å¤±è´¥æ—¶è¿”å›ä¸šåŠ¡é”™è¯¯ç ï¼ˆå¦‚ 40001ï¼‰ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šæ”¯æŒç™»å½•å¤±è´¥é”å®šç­–ç•¥ï¼›æˆåŠŸååº”ä¸‹å‘åˆ·æ–° token æ‰€éœ€ä¿¡æ¯ï¼ˆè‹¥å¯ç”¨ï¼‰ã€‚

#### GET /auth/userinfo
- **ä½œç”¨**ï¼šåœ¨é¡µé¢åˆ·æ–°æˆ–é‡æ–°è¿›å…¥ç³»ç»Ÿæ—¶ï¼Œæ ¹æ® token æ‹‰å–ä¸ªäººèµ„æ–™ã€éƒ¨é—¨ã€å²—ä½ã€æƒé™æ ‡è¯†ï¼Œç¡®ä¿å‰ç«¯èœå•/æŒ‰é’®å‡†ç¡®ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šè¿”å›å€¼éœ€åŒ…å«å²—ä½å®¡æ‰¹é˜ˆå€¼ã€æ‰€å±éƒ¨é—¨ã€å¯è®¿é—®èœå•ç­‰ï¼Œä¾¿äºå¤šç«¯åŒæ­¥ã€‚

#### POST /auth/logout
- **ä½œç”¨**ï¼šå®¢æˆ·ç«¯ä¸»åŠ¨é€€å‡ºï¼Œåç«¯è®°å½•æ“ä½œæ—¥å¿—å¹¶åœ¨é»‘åå•ä¸­æ ‡è®° tokenï¼Œé˜²æ­¢è¢«ç»§ç»­ä½¿ç”¨ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šåº”ä¿è¯å¹‚ç­‰ï¼›ç™»å‡ºæˆåŠŸåè¿”å›ç©ºæ•°æ®åŠæˆåŠŸæç¤ºã€‚

### 3.2 ç”³è¯·ç®¡ç†æ¨¡å—

#### POST /application/leave
- **ä½œç”¨**ï¼šåˆ›å»ºè¯·å‡ç”³è¯·å•ï¼Œå†™å…¥è¯·å‡è¯¦æƒ…ä¸å…³è”é™„ä»¶ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆå®¡æ‰¹ç¼–å·ä¸æµç¨‹å®ä¾‹ã€‚
- **ä¸»è¦å­—æ®µ**ï¼šè¯·å‡ç±»å‹ã€èµ·æ­¢æ—¶é—´ã€è¯·å‡å¤©æ•°ã€äº‹ç”±ã€é™„ä»¶ IDã€é¢„é€‰å®¡æ‰¹äººä¿¡æ¯ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šæœåŠ¡ç«¯éœ€æ ¡éªŒè¯·å‡å¤©æ•°ã€æ—¶é—´èŒƒå›´ã€å®¡æ‰¹äººåˆæ³•æ€§ï¼Œæ‹’ç»æäº¤åˆ°æ— å®¡æ‰¹äººéƒ¨é—¨ã€‚

#### POST /application/reimburse
- **ä½œç”¨**ï¼šåˆ›å»ºæŠ¥é”€ç”³è¯·ï¼Œè®°å½•è´¹ç”¨ç±»å‹ã€é‡‘é¢ã€å‘ç¥¨é™„ä»¶ç­‰ä¿¡æ¯å¹¶è§¦å‘æŠ¥é”€æµç¨‹ã€‚
- **ä¸»è¦å­—æ®µ**ï¼šè´¹ç”¨ç±»å‹ã€é‡‘é¢ã€å‘ç”Ÿæ—¥æœŸã€å‘ç¥¨é™„ä»¶ã€äº‹ç”±ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šåº”æ ¹æ®å²—ä½å®¡æ‰¹é¢åº¦è¿›è¡Œé¦–æ¬¡æ ¡éªŒï¼›é‡‘é¢è¿‡å¤§æ—¶å¯ç›´æ¥é…ç½®è¿›å…¥å¤šçº§æµç¨‹ã€‚

#### GET /application/my
- **ä½œç”¨**ï¼šå‘˜å·¥æŸ¥çœ‹è‡ªå·±å‘èµ·çš„æ‰€æœ‰ç”³è¯·ï¼Œæ”¯æŒæŒ‰ç±»å‹ã€çŠ¶æ€ã€æ—¶é—´èŒƒå›´ç­›é€‰å¹¶åˆ†é¡µã€‚
- **ä¸»è¦å­—æ®µ**ï¼š`pageNum`ã€`pageSize`ã€ç”³è¯·ç±»å‹ã€çŠ¶æ€ã€æ—¶é—´åŒºé—´ï¼›è¿”å›å€¼åŒ…å«æ€»æ¡æ•°ã€åˆ†é¡µè®°å½•ã€å½“å‰èŠ‚ç‚¹ç­‰ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šåˆ—è¡¨éœ€æºå¸¦å½“å‰å®¡æ‰¹èŠ‚ç‚¹ã€çŠ¶æ€æ ‡ç­¾å’Œå¯æ’¤å›æ ‡è®°ï¼Œä¾¿äºå‰ç«¯æ¸²æŸ“æ“ä½œæŒ‰é’®ã€‚

#### GET /application/{appId}
- **ä½œç”¨**ï¼šå±•ç¤ºç”³è¯·çš„å®Œæ•´è¯¦æƒ…ï¼ŒåŒ…æ‹¬åŸºç¡€ä¿¡æ¯ã€ä¸šåŠ¡å­—æ®µã€é™„ä»¶æ¸…å•ã€å®¡æ‰¹è½¨è¿¹ç­‰ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šæ ¹æ®ç”³è¯·ç±»å‹è¿”å›ç›¸åº”çš„ç»†èŠ‚ç»“æ„ï¼ˆè¯·å‡/æŠ¥é”€ï¼‰ï¼Œå¹¶é™„å¸¦æ¯ä¸ªèŠ‚ç‚¹çš„å¤„ç†æƒ…å†µï¼Œæ”¯æŒç”³è¯·äººå’Œå®¡æ‰¹äººæŸ¥çœ‹ã€‚

#### PUT /application/withdraw/{appId}
- **ä½œç”¨**ï¼šç”³è¯·äººåœ¨å¾…å®¡æ‰¹é˜¶æ®µæ’¤å›å•æ®ã€‚æ’¤å›åè¿›å…¥â€œå·²æ’¤å›â€çŠ¶æ€ï¼Œå¯å¤åˆ¶é‡æ–°å‘èµ·ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šä»…å…è®¸ç”³è¯·äººæ“ä½œä¸”çŠ¶æ€å¿…é¡»ä¸ºå¾…å®¡æ‰¹ï¼›æ’¤å›åŸå› éœ€å†™å…¥å¤‡æ³¨ï¼Œè§¦å‘é€šçŸ¥ï¼ˆå¯é€‰ï¼‰ã€‚

### 3.3 ä»»åŠ¡ç®¡ç†æ¨¡å—

#### GET /task/todo
- **ä½œç”¨**ï¼šå®¡æ‰¹äººæŸ¥çœ‹å½“å‰å¾…åŠä»»åŠ¡ï¼Œåˆ—è¡¨ä¸­éœ€è¦æ˜¾ç¤ºç”³è¯·ç±»å‹ã€ç”³è¯·äººã€èŠ‚ç‚¹ã€SLA åŠé™„ä»¶æç¤ºã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šå…è®¸å…³é”®è¯/çŠ¶æ€ç­›é€‰ï¼›æ¥å£éœ€è¿”å›å¯æ‰¹é‡æ“ä½œçš„æ ‡è®°ï¼ˆå¦‚æ˜¯å¦æ”¯æŒè½¬äº¤ã€åŠ ç­¾ï¼‰ã€‚

#### POST /task/approve
- **ä½œç”¨**ï¼šå®¡æ‰¹äººå¯¹æŒ‡å®šä»»åŠ¡æ‰§è¡ŒåŠ¨ä½œï¼ˆåŒæ„ã€æ‹’ç»ã€è½¬äº¤ã€åŠ ç­¾ï¼‰ã€‚
- **ä¸»è¦å­—æ®µ**ï¼šä»»åŠ¡ IDã€åŠ¨ä½œç±»å‹ã€å®¡æ‰¹æ„è§ã€å¯é€‰çš„ç›®æ ‡å®¡æ‰¹äºº/åŠ ç­¾äººã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šå¿…é¡»éªŒè¯ä»»åŠ¡å½’å±ä¸æƒé™ï¼›åŠ¨ä½œç»“æœä¼šæ›´æ–°ç”³è¯·çŠ¶æ€ã€ç”Ÿæˆå†å²è®°å½•ï¼Œå¹¶å¯èƒ½æ¨é€ä¸‹ä¸€èŠ‚ç‚¹ã€‚

#### GET /task/done
- **ä½œç”¨**ï¼šå®¡æ‰¹äººæŸ¥è¯¢è‡ªå·±çš„å·²åŠè®°å½•ï¼Œä¾¿äºå›é¡¾æ„è§æˆ–å¤„ç†æŠ•è¯‰ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šè¿”å›åŠ¨ä½œã€æ„è§ã€å®Œæˆæ—¶é—´ã€å…³è”ç”³è¯·åŸºæœ¬ä¿¡æ¯ï¼›é»˜è®¤æŒ‰æ“ä½œæ—¶é—´å€’åºã€‚

### 3.4 å®¡æ‰¹å†å²æ¨¡å—

#### GET /history/{appId}
- **ä½œç”¨**ï¼šä»¥æ—¶é—´è½´å½¢å¼è¿”å›æŸä¸ªç”³è¯·çš„å…¨éƒ¨æµè½¬èŠ‚ç‚¹ï¼ŒåŒ…æ‹¬æäº¤ã€å®¡æ‰¹ã€è½¬äº¤ã€æ’¤å›ç­‰ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šæ¯ä¸ªèŠ‚ç‚¹éœ€åŒ…å«èŠ‚ç‚¹åç§°ã€å¤„ç†äººã€åŠ¨ä½œã€æ„è§ã€æ—¶é—´æˆ³ã€ä¸‹ä¸€èŠ‚ç‚¹æè¿°ï¼›ä¾¿äºå‰ç«¯å±•ç¤ºåœ¨è¯¦æƒ…é¡µæˆ–å¯¹å¤–å¯¼å‡ºã€‚

### 3.5 æ–‡ä»¶ç®¡ç†æ¨¡å—

#### POST /file/upload
- **ä½œç”¨**ï¼šä¸Šä¼ ä¸ç”³è¯·ç›¸å…³çš„é™„ä»¶ï¼ˆè¯æ˜ã€å‘ç¥¨ã€å®¡æ‰¹æ–‡ä»¶ï¼‰ï¼Œç»Ÿä¸€è¿”å›å—æ§çš„æ–‡ä»¶ ID ä¸è®¿é—® URLã€‚
- **ä¸»è¦å­—æ®µ**ï¼šäºŒè¿›åˆ¶æ–‡ä»¶æµã€ä¸šåŠ¡ç±»å‹ï¼ˆè¯·å‡/æŠ¥é”€ç­‰ï¼‰ã€å¯é€‰å¤‡æ³¨ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šéœ€æ ¡éªŒæ–‡ä»¶å¤§å°ã€ç±»å‹ï¼ˆå¦‚ jpg/png/pdf/docx ç­‰ï¼‰ï¼Œå¹¶è®°å½•ä¸Šä¼ äººã€æ¥æºå•å·ï¼›æ”¯æŒæ‰©å±•æ–­ç‚¹ç»­ä¼ ã€‚

#### GET /file/download/{fileId}
- **ä½œç”¨**ï¼šæ ¹æ®æ–‡ä»¶ ID ä¸‹è½½é™„ä»¶ã€‚ä»…ç”³è¯·äººã€å½“å‰å®¡æ‰¹äººã€ç®¡ç†å‘˜å¯è®¿é—®ï¼Œä¸”æ¯æ¬¡è®¿é—®éƒ½ä¼šè®°å…¥å®¡è®¡æ—¥å¿—ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šåº”æ ¡éªŒè¯·æ±‚è€…èº«ä»½ï¼›å¦‚æœå¯ç”¨ä¸´æ—¶ç­¾åï¼Œè¿”å›å‰ç”Ÿæˆå¸¦è¿‡æœŸæ—¶é—´çš„é“¾æ¥ã€‚

#### DELETE /file/{fileId}
- **ä½œç”¨**ï¼šç®¡ç†å‘˜æˆ–æ–‡ä»¶æ‰€æœ‰è€…åˆ é™¤æ— æ•ˆé™„ä»¶ï¼Œé‡Šæ”¾å­˜å‚¨ç©ºé—´ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šåˆ é™¤åŠ¨ä½œéœ€è®°æ—¥å¿—ï¼Œä¸”ä¸å…è®¸åˆ é™¤æ­£åœ¨å®¡æ‰¹æµç¨‹ä¸­å¼•ç”¨çš„é™„ä»¶ã€‚

### 3.6 ç³»ç»Ÿç®¡ç†æ¨¡å—ï¼ˆç®¡ç†å‘˜ï¼‰

#### GET /system/user/list
- **ä½œç”¨**ï¼šåˆ†é¡µæŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ï¼Œæ”¯æŒæŒ‰ç”¨æˆ·åã€éƒ¨é—¨ç­›é€‰ï¼Œç”¨äºåå°ç®¡ç†ä¸æ‰¹é‡æ“ä½œã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šè¿”å›å­—æ®µéœ€åŒ…å«è´¦å·çŠ¶æ€ã€æ‰€å±éƒ¨é—¨ã€å²—ä½ã€æœ€è¿‘ç™»å½•æ—¶é—´ç­‰ï¼Œæ–¹ä¾¿é£æ§å®¡è®¡ã€‚

#### POST /system/user
- **ä½œç”¨**ï¼šç®¡ç†å‘˜åˆ›å»ºæˆ–å¯¼å…¥ç”¨æˆ·ï¼Œå¹¶ä¸€æ¬¡æ€§ç»‘å®šè§’è‰²ã€å²—ä½ï¼Œå®ç°æƒé™ç«‹å³ç”Ÿæ•ˆã€‚
- **ä¸»è¦å­—æ®µ**ï¼šè´¦å·ä¿¡æ¯ã€åˆå§‹å¯†ç ã€éƒ¨é—¨ IDã€è§’è‰² ID é›†ã€å²—ä½ ID é›†ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šä¿å­˜åéœ€è§¦å‘é€šçŸ¥ï¼ˆé‚®ä»¶/çŸ­ä¿¡å¯é€‰ï¼‰å¹¶è®°å½•æ“ä½œæ—¥å¿—ï¼›å¯†ç æŒ‰å®‰å…¨è§„èŒƒåŠ å¯†ã€‚

#### GET /system/dept/tree
- **ä½œç”¨**ï¼šä»¥æ ‘å½¢ç»“æ„è¿”å›ç»„ç»‡æ¶æ„ï¼Œä¾›å®¡æ‰¹äººé€‰æ‹©å™¨ã€å²—ä½é…ç½®ã€æŠ¥è¡¨ç­›é€‰ç­‰åœºæ™¯å¤ç”¨ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šèŠ‚ç‚¹åŒ…å«éƒ¨é—¨ IDã€åç§°ã€çˆ¶çº§ã€æ’åºã€è´Ÿè´£äººç­‰ä¿¡æ¯ï¼›éœ€è¦æ”¯æŒæ‡’åŠ è½½æˆ–ä¸€æ¬¡æ€§åŠ è½½ã€‚

#### POST /system/dept
- **ä½œç”¨**ï¼šæ–°å¢æˆ–è°ƒæ•´éƒ¨é—¨èŠ‚ç‚¹ï¼Œç»´æŠ¤ç»„ç»‡ç»“æ„çš„ä¸€è‡´æ€§ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šéœ€æ ¡éªŒåŒçº§é‡åã€æ’åºå†²çªï¼Œå¹¶æ›´æ–°ç¼“å­˜æˆ–é€šçŸ¥å‰ç«¯åˆ·æ–°æ ‘ç»“æ„ã€‚

> è‹¥éœ€å²—ä½ã€è§’è‰²ã€æƒé™ç­‰æ›´å¤šæ¥å£ï¼Œè¯·å‚è€ƒåç«¯å¼€å‘æ–‡æ¡£ä¸­çš„æ¨¡å—åˆ’åˆ†ï¼›æœ¬è¡¨åˆ—ä¸¾çš„æ˜¯å½“å‰ MVP çš„ä¸»æµç¨‹æ¥å£ã€‚

### 3.7 ç»Ÿè®¡æ¨¡å—

#### GET /statistics/personal
- **ä½œç”¨**ï¼šä¸ºå‘˜å·¥é¦–é¡µä»ªè¡¨ç›˜æä¾› KPIï¼Œå¦‚ç”³è¯·æ€»æ•°ã€é€šè¿‡ç‡ã€æŒ‰ç±»å‹æ‹†åˆ†ç­‰ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šéœ€æ”¯æŒæŒ‰æ—¶é—´èŒƒå›´ï¼ˆæœ¬å‘¨/æœ¬æœˆ/æœ¬å¹´ï¼‰åˆ‡æ¢ï¼Œè¿”å›ç»“æ„ç®€å•æ˜äº†ï¼Œæ–¹ä¾¿å‰ç«¯ç›´æ¥ç»˜åˆ¶å›¾è¡¨ã€‚

#### GET /statistics/dept
- **ä½œç”¨**ï¼šç®¡ç†å‘˜æŸ¥çœ‹éƒ¨é—¨/å²—ä½ç»´åº¦çš„å®¡æ‰¹é‡ã€é€šè¿‡ç‡ã€æ‹’ç»ç‡ã€æ’¤å›ç‡ï¼Œç”¨äºèµ„æºè°ƒåº¦ä¸ç»©æ•ˆè€ƒæ ¸ã€‚
- **ä¸šåŠ¡è¦ç‚¹**ï¼šæ”¯æŒæ—¶é—´åŒºé—´ç­›é€‰ä¸å¯¼å‡ºï¼›å¯åœ¨å“åº”ä¸­é™„ä¸Šéƒ¨é—¨ IDï¼Œä¾¿äºç‚¹å‡»é’»å–ã€‚

## 4. é”™è¯¯ç å‚è€ƒ

| é”™è¯¯ç  | åœºæ™¯ | è¯´æ˜ |
| --- | --- | --- |
| 40001 | ç™»å½•å¤±è´¥ | ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ã€è´¦å·è¢«ç¦ç”¨ |
| 40002 | Token å¤±æ•ˆ | éœ€è¦é‡æ–°ç™»å½•æˆ–åˆ·æ–° token |
| 40003 | æƒé™ä¸è¶³ | å½“å‰è§’è‰²ä¸å…è®¸è®¿é—®è¯¥æ¥å£ |
| 40004 | ç”³è¯·ä¸å­˜åœ¨ | appId ä¸åˆæ³•æˆ–å·²è¢«åˆ é™¤ |
| 40005 | ç”³è¯·ä¸å¯æ’¤å› | çŠ¶æ€ä¸æ˜¯â€œå¾…å®¡æ‰¹â€ï¼Œç¦æ­¢æ’¤å› |
| 40006 | éç”³è¯·äººæ“ä½œ | ä»…æœ¬äººå¯æ’¤å›è‡ªå·±çš„ç”³è¯· |
| 40007 | ä»»åŠ¡ä¸å­˜åœ¨ | taskId ä¸åˆæ³•æˆ–å·²å¤„ç† |
| 40008 | æ–‡ä»¶ä¸Šä¼ å¤±è´¥ | ç±»å‹/å¤§å°ä¸ç¬¦åˆç­–ç•¥æˆ–å†™å…¥å¼‚å¸¸ |
| 50001 | æ•°æ®åº“å¼‚å¸¸ | æ•°æ®æŒä¹…åŒ–å¤±è´¥ï¼Œéœ€è¦é‡è¯•æˆ–è”ç³»ç®¡ç†å‘˜ |
| 50002 | ç³»ç»Ÿå†…éƒ¨é”™è¯¯ | æœªæ•è·å¼‚å¸¸ï¼Œæ£€æŸ¥æœåŠ¡æ—¥å¿— |

## 5. è°ƒè¯•ä¸å¯¹æ¥å»ºè®®

1. **æ¥å£è‡ªæµ‹**ï¼šä¼˜å…ˆä½¿ç”¨ Swagger/Knife4j è¿›è¡Œå®æ—¶è°ƒè¯•ï¼Œç¡®è®¤å‚æ•°ä¸è¿”å›ç»“æ„ï¼›è‹¥éœ€æ‰¹é‡æµ‹è¯•ï¼Œå¯å¯¼å‡º Postman Collectionã€‚
2. **å‰åç«¯è”è°ƒ**ï¼šç»Ÿä¸€åœ¨ `Authorization` Header ä¸­æ”¾ç½® JWTï¼›å¼€å‘ç¯å¢ƒé€šè¿‡ Vite ä»£ç† `/api` è§£å†³è·¨åŸŸã€‚
3. **æ—¥å¿—ä¸è¿½è¸ª**ï¼šæ‰€æœ‰ä¿®æ”¹æ•°æ®çš„æ¥å£ä¼šè®°å½•æ“ä½œæ—¥å¿—ï¼ˆæ“ä½œè€…ã€æ—¶é—´ã€è¯·æ±‚ä½“æ‘˜è¦ï¼‰ï¼›è‹¥å‘ç°é—®é¢˜å¯æ ¹æ® `appId` / `taskId` å›æº¯ã€‚
4. **ç‰ˆæœ¬å…¼å®¹**ï¼šæ¥å£æ–°å¢å­—æ®µæ—¶ä¿æŒå‘åå…¼å®¹ï¼›å¦‚éœ€ç ´åå¼è°ƒæ•´ï¼Œåº”æå‰åœ¨æ–‡æ¡£ä¸­æ ‡è®°ç‰ˆæœ¬åŠå‘å¸ƒæ—¥æœŸã€‚

## 6. æ–‡æ¡£ä¿¡æ¯

- **ç‰ˆæœ¬**ï¼šv1.1
- **æœ€åæ›´æ–°**ï¼š2026-01-20
- **ç»´æŠ¤äºº**ï¼šAPI è®¾è®¡ç»„

> éœ€è¦å®Œæ•´çš„è¯·æ±‚ç¤ºä¾‹ã€Mock æ•°æ®æˆ–è„šæœ¬ï¼Œè¯·è”ç³»åç«¯å›¢é˜Ÿè·å–æœ€æ–°çš„ Swagger/OpenAPI æ–‡ä»¶æˆ– Postman Collectionã€‚# å®¡æ‰¹ç³»ç»Ÿ - API æ¥å£æ–‡æ¡£

## 1. æ¥å£è§„èŒƒ

### 1.1 åŸºç¡€ä¿¡æ¯
- **åè®®**ï¼šHTTP/HTTPS
- **è¯·æ±‚æ ¼å¼**ï¼šJSON
- **å“åº”æ ¼å¼**ï¼šJSON
- **å­—ç¬¦ç¼–ç **ï¼šUTF-8
- **Base URL (å¼€å‘ç¯å¢ƒ)**ï¼š`http://localhost:8080/api`
- **Base URL (ç”Ÿäº§ç¯å¢ƒ)**ï¼š`https://api.yourcompany.com`

### 1.2 ç»Ÿä¸€å“åº”æ ¼å¼

```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {}
}
```

**å­—æ®µè¯´æ˜**ï¼š
- `code`ï¼šçŠ¶æ€ç ï¼ˆ200 æˆåŠŸï¼Œå…¶ä»–ä¸ºå¤±è´¥ï¼‰
- `message`ï¼šæç¤ºä¿¡æ¯
- `data`ï¼šå“åº”æ•°æ®

### 1.3 çŠ¶æ€ç è¯´æ˜

| çŠ¶æ€ç  | è¯´æ˜ | å¤‡æ³¨ |
|-------|------|------|
| 200 | æˆåŠŸ | - |
| 400 | å‚æ•°é”™è¯¯ | è¯·æ±‚å‚æ•°ä¸æ­£ç¡® |
| 401 | æœªè®¤è¯ | æœªç™»å½•æˆ– Token å¤±æ•ˆ |
| 403 | æ— æƒé™ | æ²¡æœ‰è®¿é—®æƒé™ |
| 404 | èµ„æºä¸å­˜åœ¨ | - |
| 500 | æœåŠ¡å™¨é”™è¯¯ | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

### 1.4 è®¤è¯æ–¹å¼

**Authorization Header**ï¼š
```
Authorization: Bearer {token}
```

## 2. è®¤è¯æ¨¡å—

### 2.1 ç”¨æˆ·æ³¨å†Œ

**æ¥å£åœ°å€**ï¼š`POST /auth/register`

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "username": "zhangsan",
  "password": "123456",
  "confirmPassword": "123456",
  "realName": "å¼ ä¸‰",
  "phone": "13800138001",
  "email": "zhangsan@example.com"
}
```

**å‚æ•°è¯´æ˜**ï¼š
- `username`ï¼šç”¨æˆ·åï¼ˆå”¯ä¸€ï¼Œ3-20å­—ç¬¦ï¼‰
- `password`ï¼šå¯†ç ï¼ˆ6-20å­—ç¬¦ï¼‰
- `confirmPassword`ï¼šç¡®è®¤å¯†ç 
- `realName`ï¼šçœŸå®å§“å
- `phone`ï¼šæ‰‹æœºå·
- `email`ï¼šé‚®ç®±

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "æ³¨å†ŒæˆåŠŸ",
  "data": {
    "userId": 10,
    "username": "zhangsan",
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}
```

### 2.2 ç¬¬ä¸‰æ–¹ç™»å½•ï¼ˆAuth.jsï¼‰

**æ¥å£åœ°å€**ï¼š`POST /auth/oauth/login`

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "provider": "qq",
  "code": "authorization_code_from_oauth",
  "state": "random_state_string"
}
```

**å‚æ•°è¯´æ˜**ï¼š
- `provider`ï¼šç¬¬ä¸‰æ–¹å¹³å°ï¼ˆqq/wechatï¼‰
- `code`ï¼šæˆæƒç 
- `state`ï¼šçŠ¶æ€ç 

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "ç™»å½•æˆåŠŸ",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "userInfo": {
      "userId": 15,
      "username": "qq_1234567",
      "realName": "QQç”¨æˆ·",
      "avatar": "http://xxx.com/avatar.jpg",
      "roles": ["ROLE_USER"]
    }
  }
}
```

### 2.3 ç”¨æˆ·ç™»å½•

**æ¥å£åœ°å€**ï¼š`POST /auth/login`

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "username": "admin",
  "password": "123456"
}
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "ç™»å½•æˆåŠŸ",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "userInfo": {
      "userId": 1,
      "username": "admin",
      "realName": "ç®¡ç†å‘˜",
      "roles": ["ROLE_ADMIN"]
    }
  }
}
```

### 2.4 è·å–ç”¨æˆ·ä¿¡æ¯

**æ¥å£åœ°å€**ï¼š`GET /auth/userinfo`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "userId": 1,
    "username": "admin",
    "realName": "ç®¡ç†å‘˜",
    "phone": "13800138000",
    "email": "admin@example.com",
    "deptName": "æ€»å…¬å¸",
    "roles": ["ROLE_ADMIN"]
  }
}
```

### 2.5 ç”¨æˆ·ç™»å‡º

**æ¥å£åœ°å€**ï¼š`POST /auth/logout`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "ç™»å‡ºæˆåŠŸ",
  "data": null
}
```

## 3. ç”³è¯·ç®¡ç†æ¨¡å—

### 3.1 åˆ›å»ºè¯·å‡ç”³è¯·

**æ¥å£åœ°å€**ï¼š`POST /application/leave`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "leaveType": 1,
  "startTime": "2026-01-20 09:00:00",
  "endTime": "2026-01-22 18:00:00",
  "days": 3,
  "reason": "å›å®¶è¿‡å¹´",
  "attachment": "/upload/2026/01/file123.pdf"
}
```

**å‚æ•°è¯´æ˜**ï¼š
- `leaveType`ï¼šè¯·å‡ç±»å‹ï¼ˆ1äº‹å‡ 2ç—…å‡ 3å¹´å‡ 4è°ƒä¼‘ï¼‰
- `startTime`ï¼šå¼€å§‹æ—¶é—´
- `endTime`ï¼šç»“æŸæ—¶é—´
- `days`ï¼šè¯·å‡å¤©æ•°
- `reason`ï¼šè¯·å‡äº‹ç”±
- `attachment`ï¼šé™„ä»¶åœ°å€ï¼ˆå¯é€‰ï¼‰

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "åˆ›å»ºæˆåŠŸ",
  "data": 10001
}
```

### 3.2 åˆ›å»ºæŠ¥é”€ç”³è¯·

**æ¥å£åœ°å€**ï¼š`POST /application/reimburse`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "expenseType": 1,
  "amount": 1500.00,
  "reason": "å·®æ—…è´¹ç”¨æŠ¥é”€",
  "invoiceAttachment": "/upload/2026/01/invoice123.pdf",
  "occurDate": "2026-01-15"
}
```

**å‚æ•°è¯´æ˜**ï¼š
- `expenseType`ï¼šè´¹ç”¨ç±»å‹ï¼ˆ1å·®æ—…è´¹ 2é¤é¥®è´¹ 3åŠå…¬è´¹ 4å…¶ä»–ï¼‰
- `amount`ï¼šæŠ¥é”€é‡‘é¢
- `reason`ï¼šæŠ¥é”€äº‹ç”±
- `invoiceAttachment`ï¼šå‘ç¥¨é™„ä»¶ï¼ˆå¿…å¡«ï¼‰
- `occurDate`ï¼šå‘ç”Ÿæ—¥æœŸ

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "åˆ›å»ºæˆåŠŸ",
  "data": 10002
}
```

### 3.3 æŸ¥è¯¢æˆ‘çš„ç”³è¯·åˆ—è¡¨

**æ¥å£åœ°å€**ï¼š`GET /application/my`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization

**è¯·æ±‚å‚æ•°**ï¼š
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-------|------|------|------|
| pageNum | int | å¦ | é¡µç ï¼ˆé»˜è®¤1ï¼‰ |
| pageSize | int | å¦ | æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤10ï¼‰ |
| appType | string | å¦ | ç”³è¯·ç±»å‹ï¼ˆleave/reimburseï¼‰ |
| status | int | å¦ | çŠ¶æ€ï¼ˆ0-5ï¼‰ |
| startTime | string | å¦ | å¼€å§‹æ—¶é—´ |
| endTime | string | å¦ | ç»“æŸæ—¶é—´ |

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "total": 25,
    "pageNum": 1,
    "pageSize": 10,
    "records": [
      {
        "appId": 10001,
        "appNo": "AP20260115000001",
        "appType": "leave",
        "title": "è¯·å‡ç”³è¯·-å›å®¶è¿‡å¹´",
        "applicantName": "å¼ ä¸‰",
        "deptName": "æŠ€æœ¯éƒ¨",
        "status": 2,
        "currentNode": "éƒ¨é—¨ç»ç†å®¡æ‰¹",
        "submitTime": "2026-01-15 10:30:00",
        "finishTime": null
      }
    ]
  }
}
```

### 3.4 æŸ¥è¯¢ç”³è¯·è¯¦æƒ…

**æ¥å£åœ°å€**ï¼š`GET /application/{appId}`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization

**è·¯å¾„å‚æ•°**ï¼š
- `appId`ï¼šç”³è¯·ID

**å“åº”ç¤ºä¾‹ï¼ˆè¯·å‡ç”³è¯·ï¼‰**ï¼š
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "appId": 10001,
    "appNo": "AP20260115000001",
    "appType": "leave",
    "title": "è¯·å‡ç”³è¯·-å›å®¶è¿‡å¹´",
    "applicantName": "å¼ ä¸‰",
    "deptName": "æŠ€æœ¯éƒ¨",
    "status": 2,
    "currentNode": "éƒ¨é—¨ç»ç†å®¡æ‰¹",
    "submitTime": "2026-01-15 10:30:00",
    "leaveDetail": {
      "leaveType": 1,
      "startTime": "2026-01-20 09:00:00",
      "endTime": "2026-01-22 18:00:00",
      "days": 3,
      "reason": "å›å®¶è¿‡å¹´",
      "attachment": "/upload/2026/01/file123.pdf"
    },
    "approvalHistory": [
      {
        "nodeName": "éƒ¨é—¨ç»ç†å®¡æ‰¹",
        "approverName": "æå››",
        "action": 1,
        "comment": "åŒæ„",
        "approveTime": "2026-01-15 14:20:00"
      }
    ]
  }
}
```

### 3.5 æ’¤å›ç”³è¯·

**æ¥å£åœ°å€**ï¼š`PUT /application/withdraw/{appId}`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization

**è·¯å¾„å‚æ•°**ï¼š
- `appId`ï¼šç”³è¯·ID

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "æ’¤å›æˆåŠŸ",
  "data": null
}
```

## 4. ä»»åŠ¡ç®¡ç†æ¨¡å—

### 4.1 æŸ¥è¯¢å¾…åŠä»»åŠ¡åˆ—è¡¨

**æ¥å£åœ°å€**ï¼š`GET /task/todo`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization

**è¯·æ±‚å‚æ•°**ï¼š
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-------|------|------|------|
| pageNum | int | å¦ | é¡µç ï¼ˆé»˜è®¤1ï¼‰ |
| pageSize | int | å¦ | æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤10ï¼‰ |

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "total": 5,
    "pageNum": 1,
    "pageSize": 10,
    "records": [
      {
        "taskId": 1001,
        "appId": 10001,
        "appNo": "AP20260115000001",
        "appType": "leave",
        "title": "è¯·å‡ç”³è¯·-å›å®¶è¿‡å¹´",
        "applicantName": "å¼ ä¸‰",
        "nodeName": "éƒ¨é—¨ç»ç†å®¡æ‰¹",
        "createTime": "2026-01-15 10:30:00"
      }
    ]
  }
}
```

### 4.2 å®¡æ‰¹ä»»åŠ¡

**æ¥å£åœ°å€**ï¼š`POST /task/approve`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "taskId": 1001,
  "action": 1,
  "comment": "åŒæ„è¯·å‡"
}
```

**å‚æ•°è¯´æ˜**ï¼š
- `taskId`ï¼šä»»åŠ¡ID
- `action`ï¼šå®¡æ‰¹åŠ¨ä½œï¼ˆ1åŒæ„ 2æ‹’ç»ï¼‰
- `comment`ï¼šå®¡æ‰¹æ„è§ï¼ˆé€‰å¡«ï¼‰

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "å®¡æ‰¹æˆåŠŸ",
  "data": null
}
```

### 4.3 æŸ¥è¯¢å·²åŠä»»åŠ¡åˆ—è¡¨

**æ¥å£åœ°å€**ï¼š`GET /task/done`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization

**è¯·æ±‚å‚æ•°**ï¼š
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-------|------|------|------|
| pageNum | int | å¦ | é¡µç ï¼ˆé»˜è®¤1ï¼‰ |
| pageSize | int | å¦ | æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤10ï¼‰ |

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "total": 20,
    "pageNum": 1,
    "pageSize": 10,
    "records": [
      {
        "taskId": 1000,
        "appId": 10000,
        "appNo": "AP20260114000001",
        "appType": "reimburse",
        "title": "æŠ¥é”€ç”³è¯·-å·®æ—…è´¹",
        "applicantName": "ç‹äº”",
        "nodeName": "éƒ¨é—¨ç»ç†å®¡æ‰¹",
        "action": 1,
        "comment": "åŒæ„",
        "finishTime": "2026-01-14 16:00:00"
      }
    ]
  }
}
```

## 5. å®¡æ‰¹å†å²æ¨¡å—

### 5.1 æŸ¥è¯¢å®¡æ‰¹å†å²

**æ¥å£åœ°å€**ï¼š`GET /history/{appId}`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization

**è·¯å¾„å‚æ•°**ï¼š
- `appId`ï¼šç”³è¯·ID

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": [
    {
      "historyId": 1,
      "nodeName": "éƒ¨é—¨ç»ç†å®¡æ‰¹",
      "approverName": "æå››",
      "action": 1,
      "comment": "åŒæ„",
      "approveTime": "2026-01-15 14:20:00",
      "nextNode": "ç»“æŸ"
    },
    {
      "historyId": 2,
      "nodeName": "æäº¤ç”³è¯·",
      "approverName": "å¼ ä¸‰",
      "action": null,
      "comment": "å‘èµ·ç”³è¯·",
      "approveTime": "2026-01-15 10:30:00",
      "nextNode": "éƒ¨é—¨ç»ç†å®¡æ‰¹"
    }
  ]
}
```

## 6. æ–‡ä»¶ç®¡ç†æ¨¡å—

### 6.1 æ–‡ä»¶ä¸Šä¼ 

**æ¥å£åœ°å€**ï¼š`POST /file/upload`

**è¯·æ±‚Headers**ï¼š
- `Authorization`: Bearer {token}
- `Content-Type`: multipart/form-data

**è¯·æ±‚å‚æ•°**ï¼š
- `file`ï¼šæ–‡ä»¶ï¼ˆform-dataï¼‰
- `bizType`ï¼šä¸šåŠ¡ç±»å‹ï¼ˆå¯é€‰ï¼Œå¦‚ï¼šleaveã€reimburseï¼‰

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "ä¸Šä¼ æˆåŠŸ",
  "data": {
    "fileId": 1001,
    "fileName": "invoice.pdf",
    "filePath": "/upload/2026/01/invoice_abc123.pdf",
    "fileSize": 102400,
    "fileUrl": "http://localhost:8080/upload/2026/01/invoice_abc123.pdf"
  }
}
```

### 6.2 æ–‡ä»¶ä¸‹è½½

**æ¥å£åœ°å€**ï¼š`GET /file/download/{fileId}`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization

**è·¯å¾„å‚æ•°**ï¼š
- `fileId`ï¼šæ–‡ä»¶ID

**å“åº”**ï¼šæ–‡ä»¶æµ

### 6.3 æ–‡ä»¶åˆ é™¤

**æ¥å£åœ°å€**ï¼š`DELETE /file/{fileId}`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization

**è·¯å¾„å‚æ•°**ï¼š
- `fileId`ï¼šæ–‡ä»¶ID

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "åˆ é™¤æˆåŠŸ",
  "data": null
}
```

## 7. ç³»ç»Ÿç®¡ç†æ¨¡å—ï¼ˆç®¡ç†å‘˜ï¼‰

### 7.1 ç”¨æˆ·ç®¡ç†

#### 7.1.1 æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨

**æ¥å£åœ°å€**ï¼š`GET /system/user/list`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization + ROLE_ADMIN

**è¯·æ±‚å‚æ•°**ï¼š
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-------|------|------|------|
| pageNum | int | å¦ | é¡µç  |
| pageSize | int | å¦ | æ¯é¡µæ•°é‡ |
| username | string | å¦ | ç”¨æˆ·åï¼ˆæ¨¡ç³ŠæŸ¥è¯¢ï¼‰ |
| deptId | long | å¦ | éƒ¨é—¨ID |

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "total": 50,
    "records": [
      {
        "userId": 1,
        "username": "admin",
        "realName": "ç®¡ç†å‘˜",
        "phone": "13800138000",
        "email": "admin@example.com",
        "deptName": "æ€»å…¬å¸",
        "status": 1
      }
    ]
  }
}
```

#### 7.1.2 åˆ›å»ºç”¨æˆ·

**æ¥å£åœ°å€**ï¼š`POST /system/user`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization + ROLE_ADMIN

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "username": "zhangsan",
  "password": "123456",
  "realName": "å¼ ä¸‰",
  "phone": "13800138001",
  "email": "zhangsan@example.com",
  "deptId": 2,
  "roleIds": [3]
}
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "åˆ›å»ºæˆåŠŸ",
  "data": 10
}
```

### 7.2 éƒ¨é—¨ç®¡ç†

#### 7.2.1 æŸ¥è¯¢éƒ¨é—¨æ ‘

**æ¥å£åœ°å€**ï¼š`GET /system/dept/tree`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": [
    {
      "deptId": 1,
      "deptName": "æ€»å…¬å¸",
      "parentId": 0,
      "children": [
        {
          "deptId": 2,
          "deptName": "æŠ€æœ¯éƒ¨",
          "parentId": 1,
          "children": []
        }
      ]
    }
  ]
}
```

#### 7.2.2 åˆ›å»ºéƒ¨é—¨

**æ¥å£åœ°å€**ï¼š`POST /system/dept`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization + ROLE_ADMIN

**è¯·æ±‚å‚æ•°**ï¼š
```json
{
  "deptName": "é”€å”®éƒ¨",
  "parentId": 1,
  "leader": "å¼ ä¸‰",
  "phone": "13800138002",
  "orderNum": 1
}
```

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "åˆ›å»ºæˆåŠŸ",
  "data": 5
}
```

## 8. ç»Ÿè®¡æ¨¡å—ï¼ˆå¿…åšï¼‰

### 8.1 ä¸ªäººç»Ÿè®¡

**æ¥å£åœ°å€**ï¼š`GET /statistics/personal`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "totalCount": 50,
    "approvedCount": 40,
    "rejectedCount": 5,
    "withdrawnCount": 5,
    "approvalRate": 80.0,
    "byType": {
      "leave": 30,
      "reimburse": 20
    }
  }
}
```

### 8.2 éƒ¨é—¨ç»Ÿè®¡

**æ¥å£åœ°å€**ï¼š`GET /statistics/dept`

**è¯·æ±‚Headers**ï¼šéœ€è¦ Authorization + ROLE_ADMIN

**è¯·æ±‚å‚æ•°**ï¼š
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|-------|------|------|------|
| startTime | string | å¦ | å¼€å§‹æ—¶é—´ |
| endTime | string | å¦ | ç»“æŸæ—¶é—´ |

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": [
    {
      "deptName": "æŠ€æœ¯éƒ¨",
      "totalCount": 100,
      "approvedCount": 85,
      "rejectedCount": 10,
      "withdrawnCount": 5
    },
    {
      "deptName": "è´¢åŠ¡éƒ¨",
      "totalCount": 50,
      "approvedCount": 45,
      "rejectedCount": 3,
      "withdrawnCount": 2
    }
  ]
}
```

## 9. é”™è¯¯ç è¯´æ˜

| é”™è¯¯ç  | é”™è¯¯ä¿¡æ¯ | è¯´æ˜ |
|-------|---------|------|
| 40001 | ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ | ç™»å½•å¤±è´¥ |
| 40002 | Token æ— æ•ˆæˆ–å·²è¿‡æœŸ | éœ€è¦é‡æ–°ç™»å½• |
| 40003 | æ— æƒè®¿é—®è¯¥èµ„æº | æƒé™ä¸è¶³ |
| 40004 | ç”³è¯·ä¸å­˜åœ¨ | ç”³è¯·IDé”™è¯¯ |
| 40005 | åªèƒ½æ’¤å›å¾…å®¡æ‰¹çŠ¶æ€çš„ç”³è¯· | ç”³è¯·çŠ¶æ€ä¸å¯¹ |
| 40006 | åªèƒ½æ’¤å›è‡ªå·±çš„ç”³è¯· | éç”³è¯·äººæ“ä½œ |
| 40007 | ä»»åŠ¡ä¸å­˜åœ¨ | ä»»åŠ¡IDé”™è¯¯ |
| 40008 | æ–‡ä»¶ä¸Šä¼ å¤±è´¥ | æ–‡ä»¶æ ¼å¼æˆ–å¤§å°ä¸ç¬¦ |
| 50001 | æ•°æ®åº“é”™è¯¯ | æœåŠ¡å™¨å¼‚å¸¸ |
| 50002 | ç³»ç»Ÿå†…éƒ¨é”™è¯¯ | æœåŠ¡å™¨å¼‚å¸¸ |

## 10. æ¥å£æµ‹è¯•ç¤ºä¾‹ï¼ˆPostman/Curlï¼‰

### 10.1 ç™»å½•
```bash
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"123456"}'
```

### 10.2 åˆ›å»ºè¯·å‡ç”³è¯·
```bash
curl -X POST http://localhost:8080/api/application/leave \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer {token}" \
  -d '{
    "leaveType": 1,
    "startTime": "2026-01-20 09:00:00",
    "endTime": "2026-01-22 18:00:00",
    "days": 3,
    "reason": "å›å®¶è¿‡å¹´"
  }'
```

### 10.3 æŸ¥è¯¢å¾…åŠä»»åŠ¡
```bash
curl -X GET "http://localhost:8080/api/task/todo?pageNum=1&pageSize=10" \
  -H "Authorization: Bearer {token}"
```

---

> ğŸ“… **æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
> ğŸ“ **æœ€åæ›´æ–°**ï¼š2026-01-14  
> ğŸ‘¤ **ç¼–å†™äºº**ï¼šAPI è®¾è®¡å¸ˆ

## é™„å½•ï¼šå¿«é€Ÿå¯¼å…¥ Postman Collection

å¯ä»¥å°†ä»¥ä¸‹JSONä¿å­˜ä¸º `.json` æ–‡ä»¶ï¼Œç„¶åå¯¼å…¥åˆ° Postman ä¸­å¿«é€Ÿæµ‹è¯•æ‰€æœ‰æ¥å£ã€‚

```json
{
  "info": {
    "name": "å®¡æ‰¹ç³»ç»Ÿ API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "è®¤è¯æ¨¡å—",
      "item": [
        {
          "name": "ç”¨æˆ·ç™»å½•",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"admin\",\n  \"password\": \"123456\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/auth/login",
              "host": ["{{base_url}}"],
              "path": ["auth", "login"]
            }
          }
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080/api"
    }
  ]
}
```
